<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Project Talanra ‚Äî Marketplace Lokal</title>
<meta name="description" content="Project Talanra - contoh marketplace lokal (Makanan, Transportasi, Penginapan, Wisata, dll)" />

<!-- Minimal CSS (single-file). Simple, responsive, modern-ish -->
<style>
  :root{
    --bg1:#e6f0ff; --bg2:#fff7cc; --card: #ffffffee;
    --accent:#0ea5e9; --accent-2:#f59e0b; --muted:#6b7280;
    --glass: rgba(255,255,255,0.12);
  }
  [data-theme="dark"]{
    --bg1:#041024; --bg2:#062341; --card: #0b1220; --accent:#38bdf8; --accent-2:#fbbf24; --muted:#9ca3af; --glass: rgba(255,255,255,0.03);
    color: #e6eef8;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(120deg,var(--bg1),var(--bg2));
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    color: #0b1220;
  }
  header{display:flex;align-items:center;gap:12px;padding:18px 20px;max-width:1100px;margin:12px auto}
  .logo{width:64px;height:64px;border-radius:10px;object-fit:cover;box-shadow:0 6px 24px rgba(0,0,0,0.12)}
  h1{font-size:20px;margin:0}
  .subtitle{font-size:13px;color:var(--muted)}
  .top-right{margin-left:auto;display:flex;gap:8px;align-items:center}
  .btn{padding:8px 12px;border-radius:10px;border:none;cursor:pointer;background:var(--card);box-shadow:0 6px 18px rgba(2,6,23,0.06)}
  .btn-primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;font-weight:600}
  .search{width:320px;padding:8px 12px;border-radius:999px;border:1px solid rgba(0,0,0,0.06)}
  [data-theme="dark"] .search{background:#0b1220;color:inherit;border:1px solid rgba(255,255,255,0.04)}
  .container{max-width:1100px;margin:18px auto;padding:0 20px}
  .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
  @media(min-width:900px){ .grid{grid-template-columns:repeat(4,1fr)} }
  .cat-card{background:var(--card);padding:12px;border-radius:12px;display:flex;gap:12px;align-items:center;cursor:pointer;transition:transform .18s, box-shadow .18s}
  .cat-card:hover{transform:translateY(-6px);box-shadow:0 16px 40px rgba(2,6,23,0.08)}
  .cat-thumb{width:84px;height:84px;border-radius:10px;object-fit:cover;flex-shrink:0}
  .cat-title{font-weight:700}
  .muted{color:var(--muted);font-size:13px}
  .section-title{display:flex;align-items:center;gap:12px;margin:18px 0}
  .providers{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
  @media(min-width:900px){ .providers{grid-template-columns:repeat(3,1fr)} }
  .provider-card{background:var(--card);padding:12px;border-radius:12px;cursor:pointer;transition:transform .15s}
  .provider-card:hover{transform:translateY(-6px)}
  .provider-thumb{width:100%;height:160px;object-fit:cover;border-radius:8px}
  .product-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
  @media(min-width:900px){ .product-grid{grid-template-columns:repeat(3,1fr)} }
  .product{background:var(--card);padding:10px;border-radius:12px;display:flex;flex-direction:column;gap:8px}
  .product img{width:100%;height:160px;object-fit:cover;border-radius:8px}
  .price{font-weight:700}
  .rating{color:#f59e0b}
  .floating-cart{position:fixed;right:18px;bottom:18px;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;padding:12px;border-radius:999px;box-shadow:0 18px 50px rgba(2,6,23,0.15);display:flex;align-items:center;gap:10px;cursor:pointer}
  .wa-btn{background:#25D366;color:white;padding:8px 10px;border-radius:10px;text-decoration:none;font-weight:600}
  .modal{position:fixed;inset:0;background:rgba(2,6,23,0.5);display:flex;align-items:center;justify-content:center;padding:20px;opacity:0;pointer-events:none;transition:opacity .18s}
  .modal.open{opacity:1;pointer-events:auto}
  .modal-card{background:var(--card);width:100%;max-width:920px;border-radius:12px;padding:16px;max-height:86vh;overflow:auto}
  .row{display:flex;gap:12px;align-items:center}
  .col{flex:1}
  input,select,textarea{padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);width:100%;background:transparent}
  [data-theme="dark"] input, [data-theme="dark"] select, [data-theme="dark"] textarea{border:1px solid rgba(255,255,255,0.04)}
  .small{font-size:13px;color:var(--muted)}
  .chip{display:inline-block;padding:6px 10px;border-radius:999px;background:var(--glass)}
  .controls{display:flex;gap:8px;flex-wrap:wrap}
  footer{padding:18px 20px;text-align:center;color:var(--muted);margin-top:40px}
  .icon-btn{background:transparent;border:1px solid rgba(0,0,0,0.06);padding:8px;border-radius:8px;cursor:pointer}
  [data-theme="dark"] .icon-btn{border:1px solid rgba(255,255,255,0.04)}
  .admin-badge{background:#111;color:#fff;padding:6px 8px;border-radius:8px;font-weight:700}
  .empty{padding:28px;border-radius:10px;background:var(--card);text-align:center}
  .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:90px;background:#111;color:white;padding:8px 14px;border-radius:10px;opacity:0;pointer-events:none;transition:opacity .2s}
  .toast.show{opacity:1;pointer-events:auto}
</style>
</head>
<body>

<!-- Header -->
<header>
  <img src="logotalanra.jpg" class="logo" alt="Logo" onerror="this.src=placeholder(64,64,'T');" />
  <div>
    <h1>Project Talanra</h1>
    <div class="subtitle">Marketplace Lokal ‚Äî Makanan ¬∑ Transportasi ¬∑ Penginapan ¬∑ Jasa & Lainnya</div>
  </div>

  <div class="top-right">
    <input id="search" class="search" placeholder="Cari penyedia atau produk..." />
    <button id="themeToggle" title="Toggle theme" class="btn icon-btn">üåó</button>
    <button id="adminToggle" class="btn">Admin</button>
  </div>
</header>

<!-- Main -->
<main class="container">
  <!-- Categories -->
  <section>
    <div class="section-title">
      <h2>Kategori</h2>
      <div class="muted">Klik kategori untuk lihat penyedia</div>
    </div>

    <div id="categories" class="grid"></div>
  </section>

  <!-- Providers -->
  <section id="providersWrap" style="margin-top:18px">
    <div class="section-title">
      <h2 id="providersTitle">Penyedia</h2>
      <div class="muted" id="providersSubtitle">Pilih kategori</div>
    </div>
    <div id="providers" class="providers"></div>
  </section>

  <!-- Products -->
  <section id="productsWrap" style="margin-top:18px;display:none">
    <div class="section-title">
      <h2 id="productsTitle">Produk</h2>
      <div class="muted" id="productsSubtitle">Dari penyedia</div>
    </div>
    <div id="products" class="product-grid"></div>
  </section>
</main>

<!-- Floating cart -->
<div id="cartBtn" class="floating-cart" title="Keranjang">
  <div id="cartCount">0</div>
  <div>Keranjang</div>
</div>

<!-- Product modal -->
<div id="modal" class="modal" aria-hidden="true">
  <div class="modal-card">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:12px">
      <h3 id="modalTitle">Detail Produk</h3>
      <div style="display:flex;gap:8px;align-items:center">
        <button id="modalClose" class="btn icon-btn">Tutup</button>
      </div>
    </div>
    <div id="modalBody" style="margin-top:12px"></div>
  </div>
</div>

<!-- Admin modal -->
<div id="adminModal" class="modal" aria-hidden="true">
  <div class="modal-card">
    <h3>Admin Panel</h3>
    <div id="adminArea"></div>
    <div style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end">
      <button id="adminClose" class="btn">Tutup</button>
    </div>
  </div>
</div>

<!-- Cart modal -->
<div id="cartModal" class="modal" aria-hidden="true">
  <div class="modal-card">
    <h3>Keranjang</h3>
    <div id="cartBody" style="margin-top:12px"></div>
    <div style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end">
      <button id="checkoutBtn" class="btn btn-primary">Checkout (dummy)</button>
      <button id="clearCartBtn" class="btn">Kosongkan</button>
    </div>
  </div>
</div>

<div id="toast" class="toast"></div>

<footer>
  ¬© Project Talanra ‚Äî demo. WhatsApp (demo): <a href="https://wa.me/6282211608688" target="_blank" class="wa-btn">Hubungi via WhatsApp</a>
</footer>

<!-- Script: data + logic -->
<script>
/* ---------------------------
   Utilities & placeholders
   --------------------------- */
const WA_LINK = 'https://wa.me/6282211608688';
function placeholder(w=200,h=200,text='IMG'){
  const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='${w}' height='${h}' viewBox='0 0 ${w} ${h}'><rect width='100%' height='100%' fill='#e6f0ff'/><text x='50%' y='50%' font-family='Arial' fill='#0b1220' font-size='24' text-anchor='middle' dominant-baseline='middle'>${text}</text></svg>`;
  return 'data:image/svg+xml;utf8,'+encodeURIComponent(svg);
}
function fmt(n){ return 'Rp'+Number(n).toLocaleString('id-ID'); }
function toast(msg){ const t=document.getElementById('toast'); t.innerText=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),2000); }

/* ---------------------------
   Initial data (seed)
   --------------------------- */
const seedData = (function(){
  const cats = [
    "Makanan","Transportasi","Penginapan","Wisata / Trip Lokal","Sewa Perahu",
    "Jasa Desain / Foto","Peralatan Outdoor","Oleh-oleh","Jasa Harian","Jasa Tato"
  ];

  const sampleImages = [
    'https://i.ibb.co/0G0Y3nX/nasi-goreng.jpg',
    'https://i.ibb.co/YZ7wH2z/food.jpg',
    'https://i.ibb.co/C0z2VCd/hotel.jpg',
    'https://i.ibb.co/Q6Z4ZBc/boat.jpg',
    'https://i.ibb.co/z7RxH2d/travel.jpg'
  ];

  const names = ["Warung Bunda","Kulina Kita","Mas Darto","Rakyat Rasa","Nusa Jaya","Dapur Lima","Si Udin","Sari Laut","IndoRide","Kapal Nusantara","Batik Oleh","Toko Outdoor","JasaKita"];
  const data = {};
  cats.forEach((cat,i)=>{
    data[cat] = [];
    for(let j=0;j<6;j++){
      const seller = {
        id: `${i}-${j}-${Date.now().toString().slice(-4)}-${Math.random().toString(36).slice(2,6)}`,
        name: `${names[(i+j)%names.length]} ${j+1}`,
        img: sampleImages[(i+j)%sampleImages.length],
        rating: Math.round((Math.random()*2+3)*10)/10,
        products: []
      };
      for(let p=0;p<6;p++){
        seller.products.push({
          id: `${seller.id}-p${p}`,
          title: `${(cat==='Makanan'?'Nasi Goreng':'Produk')} ${p+1}`,
          price: 10000 + p*5000,
          img: sampleImages[(p+i)%sampleImages.length],
          rating: Math.round((Math.random()*2+3)*10)/10,
          desc: `Deskripsi singkat untuk ${(cat==='Makanan'?'makanan':'produk')} ${p+1} dari ${seller.name}.`
        });
      }
      data[cat].push(seller);
    }
  });
  return data;
})();

/* ---------------------------
   State & persistence
   --------------------------- */
const STORAGE_KEY = 'talanra_data_v1';
const THEME_KEY = 'talanra_theme';
const CART_KEY = 'talanra_cart';
const RATINGS_KEY = 'talanra_ratings';
const ADMIN_PIN = '1234';

let db = loadData();
let cart = loadCart();
let ratings = loadRatings();

function loadData(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    if(raw) return JSON.parse(raw);
  }catch(e){}
  localStorage.setItem(STORAGE_KEY, JSON.stringify(seedData));
  return JSON.parse(JSON.stringify(seedData));
}
function saveData(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(db)); }
function loadCart(){ try{ const r=localStorage.getItem(CART_KEY); return r?JSON.parse(r):[] }catch(e){return []} }
function saveCart(){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); updateCartCount() }
function loadRatings(){ try{ const r=localStorage.getItem(RATINGS_KEY); return r?JSON.parse(r):{} }catch(e){return {}} }
function saveRatings(){ localStorage.setItem(RATINGS_KEY, JSON.stringify(ratings)); }

/* ---------------------------
   DOM elements
   --------------------------- */
const categoriesEl = document.getElementById('categories');
const providersEl = document.getElementById('providers');
const providersTitle = document.getElementById('providersTitle');
const providersSubtitle = document.getElementById('providersSubtitle');
const productsWrap = document.getElementById('productsWrap');
const productsEl = document.getElementById('products');
const productsTitle = document.getElementById('productsTitle');
const productsSubtitle = document.getElementById('productsSubtitle');
const modal = document.getElementById('modal');
const modalBody = document.getElementById('modalBody');
const modalTitle = document.getElementById('modalTitle');
const adminModal = document.getElementById('adminModal');
const adminArea = document.getElementById('adminArea');
const cartBtn = document.getElementById('cartBtn');
const cartModal = document.getElementById('cartModal');
const cartBody = document.getElementById('cartBody');
const searchInput = document.getElementById('search');
const themeToggle = document.getElementById('themeToggle');
const adminToggle = document.getElementById('adminToggle');
const toastEl = document.getElementById('toast');

/* ---------------------------
   Theme handling
   --------------------------- */
function applyTheme(){
  const t = localStorage.getItem(THEME_KEY) || 'light';
  document.documentElement.setAttribute('data-theme', t==='dark' ? 'dark' : 'light');
}
applyTheme();
themeToggle.addEventListener('click', ()=> {
  const cur = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light';
  const next = cur === 'dark' ? 'light' : 'dark';
  localStorage.setItem(THEME_KEY, next);
  applyTheme();
});

/* ---------------------------
   Render categories
   --------------------------- */
function renderCategories(filter=''){
  categoriesEl.innerHTML = '';
  Object.keys(db).forEach(cat=>{
    if(filter && !cat.toLowerCase().includes(filter.toLowerCase())) return;
    const thumb = db[cat][0]?.img || placeholder(120,120,cat[0]||'C');
    const el = document.createElement('div');
    el.className='cat-card';
    el.innerHTML = `<img class="cat-thumb" src="${thumb}" alt="${cat}" onerror="this.src='${placeholder(84,84,cat[0]||'C')}'">
      <div>
        <div class="cat-title">${cat}</div>
        <div class="small">${db[cat].length} penyedia</div>
      </div>`;
    el.addEventListener('click', ()=>openCategory(cat));
    categoriesEl.appendChild(el);
  });
}
renderCategories();

/* ---------------------------
   Open category -> providers
   --------------------------- */
function openCategory(cat){
  providersTitle.innerText = `Penyedia ‚Äî ${cat}`;
  providersSubtitle.innerText = 'Pilih penyedia untuk lihat produk';
  providersEl.innerHTML = '';
  productsWrap.style.display = 'none';
  Object.assign(window, { currentCategory: cat });
  db[cat].forEach((s,idx)=>{
    const card = document.createElement('div');
    card.className = 'provider-card';
    card.innerHTML = `<img class="provider-thumb" src="${s.img}" onerror="this.src='${placeholder(320,200,s.name.slice(0,1))}'">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
        <div>
          <div style="font-weight:700">${s.name}</div>
          <div class="small">Rating: <span class="rating">${(ratings[s.id]||s.rating).toFixed(1)}</span> ‚≠ê</div>
        </div>
        <div style="display:flex;flex-direction:column;gap:8px">
          <a class="wa-btn" href="${WA_LINK}" target="_blank">WA</a>
          <button class="btn" onclick="event.stopPropagation(); openEditProvider('${cat}', ${idx})">Edit</button>
        </div>
      </div>`;
    card.addEventListener('click', ()=>openProvider(cat, idx));
    providersEl.appendChild(card);
  });
  window.scrollTo({top:0,behavior:'smooth'});
}

/* ---------------------------
   Provider -> show products
   --------------------------- */
function openProvider(cat, idx){
  const p = db[cat][idx];
  productsWrap.style.display = '';
  productsTitle.innerText = `Produk ‚Äî ${p.name}`;
  productsSubtitle.innerText = `Dari ${p.name}`;
  productsEl.innerHTML = '';
  Object.assign(window, { currentProvider: { cat, idx } });
  p.products.forEach(pr=>{
    const div = document.createElement('div');
    div.className='product';
    div.innerHTML=`<img src="${pr.img}" onerror="this.src='${placeholder(320,220,pr.title.slice(0,1))}'">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div style="font-weight:700">${pr.title}</div>
          <div class="small">${pr.desc||''}</div>
        </div>
        <div style="text-align:right">
          <div class="price">${fmt(pr.price)}</div>
          <div class="small rating">${(ratings[pr.id]||pr.rating).toFixed(1)} ‚≠ê</div>
        </div>
      </div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="btn" onclick="event.stopPropagation(); openProductModal('${p.name}', '${pr.id}')">Lihat</button>
        <button class="btn btn-primary" onclick="event.stopPropagation(); addToCart('${p.name}','${pr.id}')">Tambah Keranjang</button>
      </div>`;
    productsEl.appendChild(div);
  });
  window.scrollTo({top:document.querySelector('main').offsetTop,behavior:'smooth'});
}

/* ---------------------------
   Modal: product detail
   --------------------------- */
function openProductModal(providerName, productId){
  const provIdx = window.currentProvider.idx;
  const cat = window.currentProvider.cat;
  const provider = db[cat][provIdx];
  const product = provider.products.find(x=>x.id===productId);
  if(!product) return;
  modalTitle.innerText = product.title;
  modalBody.innerHTML = `
    <div class="row">
      <div style="flex:1"><img src="${product.img}" style="width:100%;height:300px;object-fit:cover;border-radius:10px" onerror="this.src='${placeholder(640,360,product.title.slice(0,1))}'"></div>
      <div style="flex:1;padding-left:12px">
        <div style="font-weight:800;font-size:20px">${product.title}</div>
        <div class="small" style="margin-top:6px">${product.desc||''}</div>
        <div style="margin-top:8px;font-weight:700">${fmt(product.price)}</div>
        <div style="margin-top:8px">Rating: <span class="rating">${(ratings[product.id]||product.rating).toFixed(1)}</span> ‚≠ê</div>
        <div style="margin-top:12px;display:flex;gap:8px">
          <button class="btn btn-primary" onclick="addToCart('${provider.name}','${product.id}')">Tambah ke Keranjang</button>
          <a class="wa-btn" href="${WA_LINK}" target="_blank">Hubungi via WhatsApp</a>
        </div>
        <div style="margin-top:12px">
          <label class="small">Beri rating: </label>
          <div style="display:flex;gap:8px;margin-top:6px">
            ${[1,2,3,4,5].map(n=>`<button class="btn" onclick="setRating('${product.id}',${n})">${'‚òÖ'.repeat(n)}</button>`).join('')}
          </div>
        </div>
      </div>
    </div>
  `;
  openModal(modal);
}

/* ---------------------------
   Modal helpers
   --------------------------- */
function openModal(el){ el.classList.add('open'); el.setAttribute('aria-hidden','false'); }
function closeModal(el){ el.classList.remove('open'); el.setAttribute('aria-hidden','true'); }
document.getElementById('modalClose').addEventListener('click', ()=>closeModal(modal));
modal.addEventListener('click',(e)=>{ if(e.target===modal) closeModal(modal) });

/* ---------------------------
   Cart functions
   --------------------------- */
function updateCartCount(){ document.getElementById('cartCount').innerText = cart.length; }
function addToCart(providerName, productId){
  // find product from db
  let found = null; let provName=null;
  for(const cat of Object.keys(db)){
    for(const s of db[cat]){
      const p = s.products.find(x=>x.id===productId);
      if(p){ found = p; provName=s.name; break; }
    }
    if(found) break;
  }
  if(!found) return toast('Produk tidak ditemukan');
  cart.push({ id:found.id, title:found.title, price:found.price, img:found.img, provider:provName });
  saveCart();
  updateCartCount();
  toast('Ditambahkan ke keranjang');
}
cartBtn.addEventL
